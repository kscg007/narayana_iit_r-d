{% load static %}
<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
  <link rel="icon" type="image/ico" href="{% static 'core/images/logo.ico' %}">
  <meta charset="UTF-8" />
  <title>Narayana IIT R &amp; D</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .carousel-bg-1 { background: linear-gradient(120deg, #f8e1f4 0%, #d1f2f6 100%); }
    .carousel-bg-2 { background: linear-gradient(120deg, #ffe5ec 0%, #e0c3fc 100%); }
    .carousel-bg-3 { background: linear-gradient(120deg, #e0f7fa 0%, #fceabb 100%); }
    .carousel-anim {
      transition: opacity 0.7s cubic-bezier(.4,0,.2,1), transform 0.7s cubic-bezier(.4,0,.2,1);
    }
  </style>
</head>
<body class="overflow-x-hidden bg-gray-80">
  <header class="py-4 md:py-6">
    <div x-data="{ expanded: false }" class="container px-4 mx-auto sm:px-6 lg:px-8">
      <div class="flex items-center justify-between">
        <div class="flex-shrink-0">
          <a href="#" title="" class="flex rounded outline-none focus:ring-1 focus:ring-gray-900 focus:ring-offset-2">
            <img class="w-auto h-14" src="{% static 'core/images/logo.png' %}" alt="Logo" />
          </a>
        </div>

        <div class="flex lg:hidden">
          <button type="button" class="text-gray-900" @click="expanded = !expanded" :aria-expanded="expanded.toString()">
            <span x-show="!expanded" aria-hidden="true">
              <svg class="w-7 h-7" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M4 6h16M4 12h16M4 18h16" />
              </svg>
            </span>

            <span x-show="expanded" aria-hidden="true">
              <svg class="w-7 h-7" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
              </svg>
            </span>
          </button>
        </div>

        <nav class="hidden lg:flex lg:ml-16 lg:items-center lg:justify-center lg:space-x-10 xl:space-x-16">
          <a href="#" title="" class="text-base font-medium text-gray-900 transition-all duration-200 rounded focus:outline-none font-pj hover:text-opacity-50 focus:ring-1 focus:ring-gray-900 focus:ring-offset-2"> About </a>
          <a href="#" title="" class="text-base font-medium text-gray-900 transition-all duration-200 rounded focus:outline-none font-pj hover:text-opacity-50 focus:ring-1 focus:ring-gray-900 focus:ring-offset-2"> IIT R &amp; D </a>
          <a href="#" title="" class="text-base font-medium text-gray-900 transition-all duration-200 rounded focus:outline-none font-pj hover:text-opacity-50 focus:ring-1 focus:ring-gray-900 focus:ring-offset-2"> Contact Us </a>
        </nav>

        <div class="hidden lg:ml-auto lg:flex lg:items-center lg:space-x-10">
          <a
            href="javascript:void(0)"
            title="Login"
            class="text-base font-medium text-gray-900 transition-all duration-200 rounded focus:outline-none font-pj hover:text-opacity-50 focus:ring-1 focus:ring-gray-900 focus:ring-offset-2"
            role="button"
            @click="$dispatch('open-login')"
          >
            Login
          </a>

          <a
            href="javascript:void(0)"
            title=""
            class="inline-flex items-center justify-center px-6 py-3 text-base font-bold leading-7 text-white transition-all duration-200 bg-gray-900 border border-transparent rounded-xl hover:bg-gray-600 font-pj focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-900"
            role="button"
            @click="$dispatch('open-signup')"
          >
            Sign up
          </a>
        </div>
      </div>

      <nav x-show="expanded" x-collapse>
        <div class="px-1 py-8">
          <div class="grid gap-y-7">
            <a href="#" title="" class="flex items-center p-3 -m-3 text-base font-medium text-gray-900 transition-all duration-200 rounded-xl hover:bg-gray-50 focus:outline-none font-pj focus:ring-1 focus:ring-gray-900 focus:ring-offset-2"> About </a>
            <a href="#" title="" class="flex items-center p-3 -m-3 text-base font-medium text-gray-900 transition-all duration-200 rounded-xl hover:bg-gray-50 focus:outline-none font-pj focus:ring-1 focus:ring-gray-900 focus:ring-offset-2"> IIT R &amp; D </a>
            <a href="#" title="" class="flex items-center p-3 -m-3 text-base font-medium text-gray-900 transition-all duration-200 rounded-xl hover:bg-gray-50 focus:outline-none font-pj focus:ring-1 focus:ring-gray-900 focus:ring-offset-2"> Contact Us </a>
            <a
              href="javascript:void(0)"
              title="Login"
              class="text-base font-medium text-gray-900 transition-all duration-200 rounded focus:outline-none font-pj hover:text-opacity-50 focus:ring-1 focus:ring-gray-900 focus:ring-offset-2"
              role="button"
              @click="$dispatch('open-login')"
            >
              Login
            </a>
            <a
              href="javascript:void(0)"
              title=""
              class="inline-flex items-center justify-center px-6 py-3 text-base font-bold leading-7 text-white transition-all duration-200 bg-gray-900 border border-transparent rounded-xl hover:bg-gray-600 font-pj focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-900"
              role="button"
              @click="$dispatch('open-signup')"
            >
              Sign up
            </a>
          </div>
        </div>
      </nav>
    </div>
  </header>

  <!--Carousel-->
  <section class="relative min-h-[400px] flex items-center justify-center overflow-hidden">
    <div 
      x-data="{
        images: [
          '{% static "core/images/carousel/01.jpg" %}',
          '{% static "core/images/carousel/02.jpg" %}',
          '{% static "core/images/carousel/03.jpg" %}',
          '{% static "core/images/carousel/04.png" %}',
          '{% static "core/images/carousel/05.jpg" %}',
          '{% static "core/images/carousel/06.jpg" %}',
        ],
        active: 0,
        next() { this.active = (this.active + 1) % this.images.length },
        prev() { this.active = (this.active - 1 + this.images.length) % this.images.length },
        goTo(idx) { this.active = idx }
      }"
      class="w-full overflow-hidden relative"
    >
      <!-- Slides -->
      <div class="flex transition-transform duration-500" :style="`transform: translateX(-${active * 100}%);`">
        <template x-for="img in images" :key="img">
          <div class="w-full flex-shrink-0 flex items-center justify-center">
            <img :src="img" class="w-full object-contain" loading="lazy" />
          </div>
        </template>
      </div>
      
      <!-- Carousel Dots -->
      <div class="absolute left-0 right-0 bottom-6 flex justify-center space-x-2 z-20">
        <template x-for="(img, idx) in images" :key="'dot'+idx">
          <button
            @click="goTo(idx)"
            :class="active === idx ? 'w-6 bg-gray-900/90' : 'w-3 bg-gray-900/30'"
            class="h-3 rounded-full transition-all duration-300 mx-1 focus:outline-none"
            :aria-label="'Go to slide ' + (idx + 1)"
          ></button>
        </template>
      </div>
      <!-- Prev/Next Buttons -->
      <button @click="prev" class="absolute left-2 top-1/2 -translate-y-1/2 bg-white/70 hover:bg-white text-gray-700 rounded-full p-2 shadow z-20 focus:outline-none">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
      </button>
      <button @click="next" class="absolute right-2 top-1/2 -translate-y-1/2 bg-white/70 hover:bg-white text-gray-700 rounded-full p-2 shadow z-20 focus:outline-none">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
        </svg>
      </button>
    </div>
  </section>

  <!-- About Us -->
  <section class="py-16 bg-gray-50">
    <div class="container px-4 mx-auto sm:px-6 lg:px-8 text-center">
      <h2 class="text-3xl font-bold mb-4">About Us</h2>
      <p class="text-lg text-gray-700">
        Narayana is dedicated to nurturing the next generation of innovators and leaders. Our mission is to provide world-class education, foster research, and empower students to achieve their dreams.
      </p>
    </div>
  </section>

  <!-- Why choose Narayana-->
  <section class="py-16 bg-white">
    <div class="container px-4 mx-auto sm:px-6 lg:px-8">
      <h2 class="text-3xl font-bold text-center mb-8">Why Choose Narayana?</h2>
      <div class="grid md:grid-cols-3 gap-8">
        <!-- Feature Card 1 -->
        <div class="flex flex-col items-center bg-gray-50 rounded-xl shadow p-6 h-full">
          <div class="w-28 h-28 flex items-center justify-center mb-4 overflow-hidden rounded-full bg-white shadow">
            <img src="{% static 'core/images/features/faculty.jpg' %}" alt="Expert Faculty" class="object-cover w-full h-full" />
          </div>
          <h3 class="text-xl font-semibold mb-2">Expert Faculty</h3>
          <p class="text-gray-600">Learn from the best minds with years of experience in IIT coaching and research.</p>
        </div>
        <!-- Feature Card 2 -->
        <div class="flex flex-col items-center bg-gray-50 rounded-xl shadow p-6 h-full">
          <div class="w-28 h-28 flex items-center justify-center mb-4 overflow-hidden rounded-full bg-white shadow">
            <img src="{% static 'core/images/features/proven_result.jpg' %}" alt="Proven Results" class="object-cover w-full h-full" />
          </div>
          <h3 class="text-xl font-semibold mb-2">Proven Results</h3>
          <p class="text-gray-600">Consistent top ranks in IIT-JEE, NEET, and other competitive exams.</p>
        </div>
        <!-- Feature Card 3 -->
        <div class="flex flex-col items-center bg-gray-50 rounded-xl shadow p-6 h-full">
          <div class="w-28 h-28 flex items-center justify-center mb-4 overflow-hidden rounded-full bg-white shadow">
            <img src="{% static 'core/images/features/learning.jpg' %}" alt="Innovative Learning" class="object-cover w-full h-full" />
          </div>
          <h3 class="text-xl font-semibold mb-2">Innovative Learning</h3>
          <p class="text-gray-600">Cutting-edge curriculum and digital resources for holistic development.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Our Programs -->
  <section class="py-16 bg-white">
    <div class="container px-4 mx-auto sm:px-6 lg:px-8">
      <h2 class="text-3xl font-bold text-center mb-8">Our Programs</h2>
      <div class="grid md:grid-cols-3 gap-8">
        <div class="bg-gray-100 rounded-xl p-6 text-center">
          <h3 class="text-xl font-semibold mb-2">IIT-JEE Coaching</h3>
          <p class="text-gray-600 mb-4">Comprehensive preparation for JEE Main &amp; Advanced.</p>
          <a href="#" class="text-blue-600 font-semibold hover:underline">Learn More</a>
        </div>
        <div class="bg-gray-100 rounded-xl p-6 text-center">
          <h3 class="text-xl font-semibold mb-2">NEET Coaching</h3>
          <p class="text-gray-600 mb-4">Expert guidance for medical entrance exams.</p>
          <a href="#" class="text-blue-600 font-semibold hover:underline">Learn More</a>
        </div>
        <div class="bg-gray-100 rounded-xl p-6 text-center">
          <h3 class="text-xl font-semibold mb-2">Foundation Courses</h3>
          <p class="text-gray-600 mb-4">Early start for students in grades 6-10.</p>
          <a href="#" class="text-blue-600 font-semibold hover:underline">Learn More</a>
        </div>
      </div>
    </div>
  </section>

  <!-- Success Stories -->
  <section class="py-16 bg-gray-50">
    <div class="container px-4 mx-auto sm:px-6 lg:px-8">
      <h2 class="text-3xl font-bold text-center mb-8">Success Stories</h2>
      <div class="space-y-8">
        <div class="bg-white rounded-xl shadow p-6">
          <p class="text-gray-700 italic">"Thanks to Narayana, I secured a top rank in JEE Advanced. The faculty and study material are unmatched!"</p>
          <div class="mt-4 flex items-center">
            <img src="{% static 'core/images/students_testimonies/profile1.jpg' %}" alt="Student" class="w-12 h-12 rounded-full mr-3">
            <div>
              <div class="font-semibold">Rahul Sharma</div>
              <div class="text-gray-500 text-sm">JEE Advanced Topper, 2024</div>
            </div>
          </div>
        </div>
        <div class="bg-white rounded-xl shadow p-6">
          <p class="text-gray-700 italic">"Thanks to Narayana, I secured a top rank in JEE Advanced. The faculty and study material are unmatched!"</p>
          <div class="mt-4 flex items-center">
            <img src="{% static 'core/images/students_testimonies/profile1.jpg' %}" alt="Student" class="w-12 h-12 rounded-full mr-3">
            <div>
              <div class="font-semibold">Rahul Sharma</div>
              <div class="text-gray-500 text-sm">JEE Advanced Topper, 2024</div>
            </div>
          </div>
        </div>
        <div class="bg-white rounded-xl shadow p-6">
          <p class="text-gray-700 italic">"Thanks to Narayana, I secured a top rank in JEE Advanced. The faculty and study material are unmatched!"</p>
          <div class="mt-4 flex items-center">
            <img src="{% static 'core/images/students_testimonies/profile1.jpg' %}" alt="Student" class="w-12 h-12 rounded-full mr-3">
            <div>
              <div class="font-semibold">Rahul Sharma</div>
              <div class="text-gray-500 text-sm">JEE Advanced Topper, 2024</div>
            </div>
          </div>
        </div>
        <!-- Add more testimonials as needed -->
      </div>
    </div>
  </section>

  <section class="py-16 bg-blue-900 text-white text-center">
    <h2 class="text-3xl font-bold mb-6">Connect with Us</h2>
    <p class="mb-8 text-lg">Follow Narayana on social media and stay updated:</p>
    <div class="flex justify-center space-x-6">
      <!-- Facebook -->
      <a href="https://www.facebook.com/TheNarayanaGroup/" target="_blank" rel="noopener" aria-label="Facebook" class="hover:text-yellow-400 transition">
        <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24">
          <path d="M22 12.07C22 6.48 17.52 2 12 2S2 6.48 2 12.07c0 5.02 3.66 9.16 8.44 9.93v-7.03H7.9v-2.9h2.54V9.84c0-2.5 1.49-3.89 3.77-3.89 1.09 0 2.23.2 2.23.2v2.45h-1.26c-1.24 0-1.63.77-1.63 1.56v1.87h2.78l-.44 2.9h-2.34v7.03C18.34 21.23 22 17.09 22 12.07z"/>
        </svg>
      </a>
      <!-- X -->
      <a href="https://x.com/narayanaedu?lang=en" target="_blank" rel="noopener" aria-label="Twitter" class="hover:text-yellow-400 transition">
        <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24">
          <path d="M22.46 6c-.77.35-1.6.59-2.47.7a4.3 4.3 0 0 0 1.88-2.37 8.59 8.59 0 0 1-2.72 1.04A4.28 4.28 0 0 0 11.1 9.03c0 .34.04.67.1.99A12.13 12.13 0 0 1 3.1 5.1a4.28 4.28 0 0 0 1.32 5.7c-.7-.02-1.36-.21-1.94-.53v.05a4.28 4.28 0 0 0 3.43 4.2c-.33.09-.68.14-1.04.14-.25 0-.5-.02-.74-.07a4.29 4.29 0 0 0 4 2.98A8.6 8.6 0 0 1 2 19.54a12.13 12.13 0 0 0 6.56 1.92c7.88 0 12.2-6.53 12.2-12.2 0-.19 0-.37-.01-.56A8.72 8.72 0 0 0 24 4.59a8.5 8.5 0 0 1-2.54.7z"/>
        </svg>
      </a>
      <!-- Instagram -->
      <a href="https://www.instagram.com/thenarayanagroup/?hl=en" target="_blank" rel="noopener" aria-label="Instagram" class="hover:text-yellow-400 transition">
        <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24">
          <path d="M7.75 2h8.5A5.75 5.75 0 0 1 22 7.75v8.5A5.75 5.75 0 0 1 16.25 22h-8.5A5.75 5.75 0 0 1 2 16.25v-8.5A5.75 5.75 0 0 1 7.75 2zm0 1.5A4.25 4.25 0 0 0 3.5 7.75v8.5A4.25 4.25 0 0 0 7.75 20.5h8.5A4.25 4.25 0 0 0 20.5 16.25v-8.5A4.25 4.25 0 0 0 16.25 3.5h-8.5zm4.25 3.25a5.25 5.25 0 1 1 0 10.5 5.25 5.25 0 0 1 0-10.5zm0 1.5a3.75 3.75 0 1 0 0 7.5 3.75 3.75 0 0 0 0-7.5zm5.25.75a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
        </svg>
      </a>
      <!-- YouTube -->
      <a href="https://www.youtube.com/user/thenarayanagroup" target="_blank" rel="noopener" aria-label="YouTube" class="hover:text-yellow-400 transition">
        <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 24 24">
          <path d="M21.8 8.001a2.75 2.75 0 0 0-1.94-1.94C18.2 6 12 6 12 6s-6.2 0-7.86.06a2.75 2.75 0 0 0-1.94 1.94A28.7 28.7 0 0 0 2 12a28.7 28.7 0 0 0 .2 3.999 2.75 2.75 0 0 0 1.94 1.94C5.8 18 12 18 12 18s6.2 0 7.86-.06a2.75 2.75 0 0 0 1.94-1.94A28.7 28.7 0 0 0 22 12a28.7 28.7 0 0 0-.2-3.999zM10 15.5v-7l6 3.5-6 3.5z"/>
        </svg>
      </a>
      <!-- Official Website -->
      <a href="https://www.narayanagroup.com/" target="_blank" rel="noopener" aria-label="Website" class="hover:text-yellow-400 transition">
        <svg class="w-8 h-8" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
          <circle cx="12" cy="12" r="10" stroke="currentColor"/>
          <ellipse cx="12" cy="12" rx="6" ry="10" stroke="currentColor"/>
          <ellipse cx="12" cy="12" rx="10" ry="6" stroke="currentColor"/>
          <path d="M2 12h20" stroke="currentColor"/>
        </svg>
      </a>
    </div>
  </section>

  <!-- SIGNUP MODAL (Alpine component for signup only) -->
  <div x-data="signupComponent()" @open-signup.window="showSignup = true">
    <!-- Overlay -->
    <div
      @click.self="closeSignup()"
      x-show="showSignup"
      x-transition.opacity
      class="fixed inset-0 backdrop-blur-sm z-40 pointer-events-auto"
      style="background-color: rgba(189, 221, 228, 0.3);"
    ></div>

    <!-- Signup Card -->
    <div
      x-show="showSignup"
      x-transition
      class="fixed inset-0 flex items-center justify-center z-50 p-6"
      style="display: none;"
    >
      <div class="relative bg-white bg-opacity-60 backdrop-blur-lg rounded-2xl shadow-2xl max-w-md w-full p-8 border border-gray-200">
      <button
        @click="closeSignup()"
        class="absolute top-4 right-4 text-gray-600 hover:text-gray-900 transition-colors duration-200 text-3xl font-semibold focus:outline-none"
        aria-label="Close signup form"
      >
        &times;
      </button>

      <!-- Step 1: Name and Email input -->
      <template x-if="!otpSent">
        <div>
          <h2 class="text-3xl font-extrabold mb-6 text-gray-900 tracking-tight text-center" style="font-family: 'Courier New', Courier, monospace;">Sign Up</h2>

          <div class="relative mb-4">
            <img src="{% static 'images/person.svg' %}" alt="Mail icon" class="w-5 h-5 absolute left-3 top-1/2 transform -translate-y-1/2 pointer-events-none" aria-hidden="true" />
            <input
              type="text"
              placeholder="Name"
              x-model="userName"
              class="w-full pl-14 p-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
              autocomplete="name"
            />
          </div>

          <div class="relative mb-4">
            <img src="{% static 'images/mail.svg' %}" alt="Mail icon" class="w-5 h-5 absolute left-3 top-1/2 transform -translate-y-1/2 pointer-events-none" aria-hidden="true" />
            <input
              type="email"
              placeholder="Email"
              x-model="userEmail"
              class="w-full pl-14 p-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
              autocomplete="email"
            />
          </div>

          <!-- Inline error message -->
          <div x-show="errorMessage" class="mb-6 text-red-600 font-medium text-center" x-text="errorMessage"></div>

          <button
            class="w-full text-white font-semibold py-4 rounded-lg shadow-md transition duration-300 disabled:cursor-not-allowed"
            @click="sendOtp()"
            :disabled="!userName || !userEmail"
            :style="!userName || !userEmail 
              ? 'background-color: #91DDCF; opacity: 1; cursor: not-allowed;' 
              : 'background-color: #295F98; opacity: 1; cursor: pointer;'"
          >
            Send OTP
          </button>
        </div>
      </template>

      <!-- Step 2: OTP input -->
      <template x-if="otpSent && !otpVerified">
        <div>
          <h2 class="text-3xl font-extrabold mb-6 text-gray-900 tracking-tight text-center">Enter OTP</h2>
          <div class="flex justify-center space-x-2 mb-4">
            <template x-for="(digit, index) in otpDigits" :key="index">
              <input
                type="text"
                maxlength="1"
                x-model="otpDigits[index]"
                @input="onOtpInput(index, $event)"
                @keydown.backspace="onOtpBackspace(index, $event)"
                @paste="onOtpPaste($event)"
                class="w-12 h-12 text-center text-lg font-bold border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent transition"
                x-ref="otpInput"
              />
            </template>
          </div>
          <!-- Timer -->
          <div class="text-center text-gray-600 mb-4">
            <span>OTP expires in: </span>
            <span x-text="timerDisplay"></span>
          </div>
          <!-- Resend OTP as hyperlink -->
          <div class="text-center mb-4">
            <a
              href="#"
              class="font-semibold hover:underline transition duration-300"
              @click.prevent="resendOtp()"
              :class="canResend ? 'text-green-600 hover:text-green-700' : 'text-gray-400 pointer-events-none'"
            >
              Resend OTP
            </a>
          </div>

          <!-- Info Message -->
          <div x-show="infoMessage" class="mb-4 text-center text-green-600 font-medium" x-html="infoMessage"></div>

          <!-- Inline error message -->
          <div x-show="errorMessage" class="mt-4 font-medium text-center" style="color: #B03052;" x-html="errorMessage"></div>

          <button
            class="w-full text-white font-semibold py-4 rounded-lg shadow-md transition duration-300 disabled:cursor-not-allowed"
            @click="verifyOtp()"
            :disabled="otpDigits.join('').length < 6"
            :style="otpDigits.join('').length < 6 
              ? 'background-color: #95D2B3; opacity: 1; cursor: not-allowed;' 
              : 'background-color: #00879E; opacity: 1; cursor: pointer;'"
          >
            Verify OTP
          </button>
        </div>
      </template>

      <!-- Step 3: Success message -->
      <template x-if="otpVerified">
        <div
          class="fixed inset-0 flex items-center justify-center z-50 p-6"
          style="background-color: rgba(0, 0, 0, 0.5);"
          @keydown.window.escape="closeSignup()"
        >
          <div class="bg-white rounded-lg shadow-lg p-8 max-w-md w-full text-center relative">
            <h2 class="text-3xl font-extrabold mb-6 tracking-tight" style="color: #143D60;"> Success</h2>
            <div class="flex items-center justify-center h-full">
              <img class="w-auto h-10" src="{% static 'core/images/success.png' %}" alt="SuccessLogo" />
            </div>
            <p class="text-gray-700 mb-6" style="color: #003092;" x-text="successMessage"></p>
            <button
              class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-6 rounded-lg shadow-md transition duration-300"
              @click="closeSignup()"
            >
              OK
            </button>
            <button
              class="absolute top-4 right-4 text-gray-600 hover:text-gray-900 text-2xl font-bold"
              @click="closeSignup()"
              aria-label="Close"
            >
              &times;
            </button>
          </div>
        </div>
      </template>
    </div>
    </div>
    


    <!-- LOGIN MODAL (Persistent Alpine component for login) -->
    <div 
      x-data="loginComponent()" 
      @open-login.window="showLogin = true"
      x-init="$watch('showGoogleAuth', value => { if(value) { $nextTick(() => { $el.querySelector('[tabindex]').focus(); }); } })"
    >
      <!-- Overlay -->
      <div
        @click.self="closeLogin()"
        x-show="showLogin || showSetPassword || showGoogleAuth"
        x-transition.opacity
        class="fixed inset-0 backdrop-blur-sm z-40 pointer-events-auto"
        style="background-color: rgba(189, 221, 228, 0.3);"
      ></div>

      <!-- Login Card -->
      <div
        x-show="showLogin || showSetPassword"
        x-transition
        class="fixed inset-0 flex items-center justify-center z-50 p-6"
        style="display: none;"
      >
        <div class="relative bg-white bg-opacity-60 backdrop-blur-lg rounded-2xl shadow-2xl max-w-md w-full p-8 border border-gray-200">
          <!-- Close Button -->
          <button
            @click="closeLogin()"
            class="absolute top-4 right-4 text-gray-600 hover:text-gray-900 transition-colors duration-200 text-3xl font-semibold focus:outline-none"
            aria-label="Close login form"
          >
            &times;
          </button>

          <!-- Step 1: Email Input -->
          <template x-if="!action && showLogin">
            <div>
              <h2 class="text-3xl font-extrabold mb-6 text-gray-900 tracking-tight text-center">Login</h2>
              <div class="relative mb-4">
                <img src="{% static 'images/mail.svg' %}" alt="Mail icon" class="w-5 h-5 absolute left-3 top-1/2 transform -translate-y-1/2 pointer-events-none" aria-hidden="true" />
                <input
                  type="email"
                  placeholder="Enter your email"
                  x-model="loginEmail"
                  class="w-full pl-14 p-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
                  autocomplete="email"
                />
              </div>
              <div x-show="errorMessage" class="text-red-500 text-sm mt-2" x-text="errorMessage"></div>
              <button
                @click="submitEmail()"
                class="w-full bg-blue-500 text-white py-2 rounded-lg mt-4 hover:bg-blue-600"
              >
                Next
              </button>
            </div>
          </template>

          <!-- Step 2a: Tabbed Login Method Selector (Password, OTP, Google Authenticator) -->
          <template x-if="action === 'login_password_or_otp_or_google_authenticator' && showLogin">
            <div
              x-data="{
                loginStep: 'password',
                prevStep: 'password',
                direction: 'right',
                setStep(step) {
                  this.direction = this.getDirection(this.loginStep, step);
                  this.prevStep = this.loginStep;
                  this.loginStep = step;
                },
                getDirection(current, next) {
                  const order = ['password', 'otp', 'totp'];
                  return order.indexOf(next) > order.indexOf(current) ? 'right' : 'left';
                }
              }"
            >
              <h2 class="text-2xl font-bold mb-6 text-center text-gray-900">Choose Login Method</h2>
              <ul class="flex border-b mb-6" role="tablist">
                <li class="flex-1 text-center">
                  <button
                    type="button"
                    class="w-full py-2 px-4 border-b-2 transition-colors duration-300 font-semibold focus:outline-none"
                    :style="loginStep === 'password'
                      ? 'border-bottom: 2px solid #1E90FF; color: #1E90FF;'
                      : 'border-bottom: 2px solid transparent; color: #A0AEC0;'"
                    @click="setStep('password'); passwordError = ''"
                    role="tab"
                    :aria-selected="loginStep === 'password'"
                  >
                    Password
                  </button>
                </li>
                <li class="flex-1 text-center">
                  <button
                    type="button"
                    class="w-full py-2 px-4 border-b-2 transition-colors duration-300 font-semibold focus:outline-none"
                    :style="loginStep === 'otp'
                      ? 'border-bottom: 2px solid #10B981; color: #10B981;'
                      : 'border-bottom: 2px solid transparent; color: #A0AEC0;'"
                    @click="setStep('otp'); otpError = ''"
                    role="tab"
                    :aria-selected="loginStep === 'otp'"
                  >
                    OTP
                  </button>
                </li>
                <li class="flex-1 text-center">
                  <button
                    type="button"
                    class="w-full py-2 px-4 border-b-2 transition-colors duration-300 font-semibold focus:outline-none"
                    :style="loginStep === 'totp'
                      ? 'border-bottom: 2px solid #A259FF; color: #A259FF;'
                      : 'border-bottom: 2px solid transparent; color: #A0AEC0;'"
                    @click="setStep('totp'); totpError = ''"
                    role="tab"
                    :aria-selected="loginStep === 'totp'"
                  >
                    Authenticator
                  </button>
                </li>
              </ul>
              

              <div class="relative min-h-[180px] overflow-hidden"> <!-- Adjust min-h as needed -->
                <!-- Password Login -->
                <div
                  x-show="loginStep === 'password'"
                  x-cloak
                  class="absolute inset-0 w-full"
                  :x-transition:enter="direction === 'right' ? 'transition transform ease-out duration-300' : 'transition transform ease-out duration-300'"
                  :x-transition:enter-start="direction === 'right' ? 'opacity-0 translate-x-full' : 'opacity-0 -translate-x-full'"
                  x-transition:enter-end="opacity-100 translate-x-0"
                  :x-transition:leave="direction === 'right' ? 'transition transform ease-in duration-200' : 'transition transform ease-in duration-200'"
                  x-transition:leave-start="opacity-100 translate-x-0"
                  :x-transition:leave-end="direction === 'right' ? 'opacity-0 -translate-x-full' : 'opacity-0 translate-x-full'"
                >
                  <div class="relative mb-4">
                    <input id="login-password" name="login-password-field" :type="showPassword ? 'text' : 'password'" placeholder="Password" x-model="password" class="w-full p-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition" autocomplete="new-password"/>
                    <!-- Eye Icon Button -->
                    <button type="button" @click="showPassword = !showPassword" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 focus:outline-none" aria-label="Toggle password visibility">
                      <template x-if="showPassword">
                        <img class="w-auto h-5" src="{% static 'images/eye_open.svg' %}" alt="Show password" />
                      </template>
                      <template x-if="!showPassword">
                        <img class="w-auto h-5" src="{% static 'images/eye_closed.svg' %}" alt="Hide password" />
                      </template>
                    </button>
                  </div>
                  <div x-show="passwordError" class="text-red-600 text-sm mb-2 text-center" x-text="passwordError"></div>
                  <button
                    class="w-full text-white py-2 rounded-lg font-semibold transition"
                    :style="loginStep === 'password'
                      ? 'background-color: #1E90FF;'
                      : 'background-color: #A0AEC0;'"
                    @click="submitPassword()"
                  >
                    Login
                  </button>
                </div>

                <!-- OTP Login -->
                <div
                  x-show="loginStep === 'otp'"
                  x-cloak
                  class="absolute inset-0 w-full"
                  :x-transition:enter="direction === 'right' ? 'transition transform ease-out duration-300' : 'transition transform ease-out duration-300'"
                  :x-transition:enter-start="direction === 'right' ? 'opacity-0 translate-x-full' : 'opacity-0 -translate-x-full'"
                  x-transition:enter-end="opacity-100 translate-x-0"
                  :x-transition:leave="direction === 'right' ? 'transition transform ease-in duration-200' : 'transition transform ease-in duration-200'"
                  x-transition:leave-start="opacity-100 translate-x-0"
                  :x-transition:leave-end="direction === 'right' ? 'opacity-0 -translate-x-full' : 'opacity-0 translate-x-full'"
                >
                  <input type="text" x-model="otp" maxlength="6" placeholder="Enter OTP" class="w-full mb-3 p-3 border rounded-lg focus:ring-2 focus:ring-green-500" />
                  <div x-show="otpError" class="text-red-600 text-sm mb-2 text-center" x-text="otpError"></div>
                  <div class="flex gap-2">
                    <button
                      class="flex-1 text-white py-2 rounded-lg font-semibold transition"
                      :style="loginStep === 'otp'
                        ? 'background-color: #10B981;'
                        : 'background-color: #A0AEC0;'"
                      @click="submitOtp()"
                    >
                      Login with OTP
                    </button>
                    <button
                      class="flex-1 text-gray-700 py-2 rounded-lg font-semibold transition"
                      :style="'background-color: #F3F4F6;'"
                      @click="sendLoginOtp()"
                    >
                      Send OTP
                    </button>
                  </div>
                </div>

                <!-- Google Authenticator Login -->
                <div
                  x-show="loginStep === 'totp'"
                  x-cloak
                  class="absolute inset-0 w-full"
                  :x-transition:enter="direction === 'right' ? 'transition transform ease-out duration-300' : 'transition transform ease-out duration-300'"
                  :x-transition:enter-start="direction === 'right' ? 'opacity-0 translate-x-full' : 'opacity-0 -translate-x-full'"
                  x-transition:enter-end="opacity-100 translate-x-0"
                  :x-transition:leave="direction === 'right' ? 'transition transform ease-in duration-200' : 'transition transform ease-in duration-200'"
                  x-transition:leave-start="opacity-100 translate-x-0"
                  :x-transition:leave-end="direction === 'right' ? 'opacity-0 -translate-x-full' : 'opacity-0 translate-x-full'"
                >
                  <input type="text" x-model="totp" maxlength="6" placeholder="Enter Google Authenticator Code" class="w-full mb-3 p-3 border rounded-lg focus:ring-2 focus:ring-purple-500" />
                  <div x-show="totpError" class="text-red-600 text-sm mb-2 text-center" x-text="totpError"></div>
                  <button
                    class="w-full text-white py-2 rounded-lg font-semibold transition"
                    :style="loginStep === 'totp'
                      ? 'background-color: #003092;'
                      : 'background-color: #A0AEC0;'"
                    @click="submitTotp()"
                  >
                    Login with Google Authenticator
                  </button>
                </div>
              </div>
              <div x-show="loginStep === 'otp' && otpSent" class="text-green-600 text-sm mb-2 text-center">
                OTP sent to your email.
              </div>
            </div>
          </template>

          <!-- Step 2b: Set Password -->
          <template x-if="showSetPassword">
            <div>
              <div class="flex items-center justify-center h-full">
                <img class="w-auto h-10" src="{% static 'images/password2.svg' %}" alt="PasswordLogo" />
              </div>
              <br>
              <h2 class="text-3xl font-extrabold mb-6 text-gray-900 tracking-tight text-center">Set Password</h2>
              <div class="relative mb-4">
                <label for="new-password" class="block text-sm font-medium text-gray-700">Enter New Password</label>
                <div class="relative">
                  <input
                    id="new-password"
                    :type="showPassword ? 'text' : 'password'"
                    placeholder="Enter your new password"
                    x-model="password"
                    class="w-full p-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
                    autocomplete="new-password"
                  />
                  <button
                    type="button"
                    @click="showPassword = !showPassword"
                    class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 focus:outline-none"
                    aria-label="Toggle password visibility"
                  >
                    <template x-if="showPassword">
                      <img class="w-auto h-5" src="{% static 'images/eye_open.svg' %}" alt="EyeOpen" />
                    </template>
                    <template x-if="!showPassword">
                      <img class="w-auto h-5" src="{% static 'images/eye_closed.svg' %}" alt="EyeClosed" />
                    </template>
                  </button>
                </div>
                <ul class="text-sm text-gray-500 mt-2">
                  <li x-show="!passwordValidations.minLength" class="text-red-500">At least 12 characters</li>
                  <li x-show="!passwordValidations.uppercase" class="text-red-500">At least one uppercase letter</li>
                  <li x-show="!passwordValidations.lowercase" class="text-red-500">At least one lowercase letter</li>
                  <li x-show="!passwordValidations.number" class="text-red-500">At least one number</li>
                  <li x-show="!passwordValidations.symbol" class="text-red-500">At least one special character</li>
                </ul>
              </div>
              <div class="relative mb-4">
                <label for="confirm-password" class="block text-sm font-medium text-gray-700">Confirm New Password</label>
                <input
                  id="confirm-password"
                  :type="showPassword ? 'text' : 'password'"
                  placeholder="Confirm your new password"
                  x-model="confirmPassword"
                  class="w-full p-4 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
                  autocomplete="new-password"
                />
                <p x-show="confirmPasswordError" class="text-red-500 text-sm mt-2" x-text="confirmPasswordError"></p>
              </div>
              <button
                class="w-full text-white font-semibold py-4 rounded-lg shadow-md transition duration-300 disabled:cursor-not-allowed"
                @click="submitSetPassword()"
                :disabled="!password || !confirmPassword || !!passwordError || !!confirmPasswordError"
                :style="!password || !confirmPassword || !!passwordError || !!confirmPasswordError
                  ? 'background-color: #91DDCF; opacity: 1; cursor: not-allowed;'
                  : 'background-color: #295F98; opacity: 1; cursor: pointer;'"
              >
                Submit
              </button>
            </div>
          </template>
        </div>
      </div>

      <!-- Step 3: Google Authenticator Setup (separate modal layer, stays open until user closes) -->
      <div
      x-show="showGoogleAuth"
      x-transition
      class="fixed inset-0 flex items-center justify-center z-50 p-6"
      style="display: none;"
      @keydown.window.escape="closeGoogleAuth()" tabindex="0"
      >
      <div class="relative bg-white rounded-2xl shadow-2xl max-w-md w-full p-8 border border-gray-200 flex flex-col items-center">
        <!-- Close (X) Button -->
        <button
          @click="closeGoogleAuth()"
          class="absolute top-4 right-4 text-gray-600 hover:text-gray-900 text-2xl font-bold"
          aria-label="Close"
        >
          &times;
        </button>
        <h2 class="text-3xl font-extrabold mb-6 text-gray-900 tracking-tight text-center">Set Up Google Authenticator</h2>
        <p class="mb-4 text-center">Scan the QR code below with your Google Authenticator app. </p>
        <div class="flex justify-center mb-4">
          <img :src="qrCodeUrl" alt="Google Authenticator QR Code" class="w-48 h-48" />
        </div>
        <!-- Skip Link just above the Done button, centered and light gray -->
        Optional
        <a href="#"
          class="block text-center text-gray-400 hover:text-gray-600 text-sm mb-2 transition"
          @click.prevent="closeGoogleAuth()">
        (Skip)
        </a>
        <button
          @click="closeGoogleAuth()"
          class="w-full bg-blue-500 text-white py-2 rounded-lg mt-0 hover:bg-blue-600"
        >
          Done
        </button>
      </div>
      </div>
    </div>


    <script src="{% static 'js/landing.js' %}"></script>
    <script src="{% static 'js/signup.js' %}" defer></script>
    <script src="{% static 'js/login.js' %}" defer></script>
    <script src="https://unpkg.com/@alpinejs/collapse@3.x.x/dist/cdn.min.js" defer></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    
</body>
</html>